
[20251003-195021] INIT_PLAN
{
  "case_name": "利用BatteryCapacityDetectControl工具记录电脑通过播放本地视频将电池电量从100%放电到10%所用的总时间并上传到测试平台",
  "case_desc": "利用BatteryCapacityDetectControl工具记录电脑通过播放本地视频将电池电量从100%放电到10%所用的总时间并上传到测试平台",
  "type": 1,
  "steps": [
    {
      "order": 1,
      "action": "设置电池测试环境：启用TPG、音量10、亮度88、重启并开启TestMode",
      "tool": "AutoSet",
      "params": "-battery -TPG -Volume 10 -Brightness 88 -Restart -Testmode Enable",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤1；理由：通用电池测试前环境配置"
    },
    {
      "order": 2,
      "action": "采集测试机软硬件信息",
      "tool": "CollectHardwareSoftwareInfo",
      "params": "",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤2；理由：信息收集为标准前置步骤"
    },
    {
      "order": 3,
      "action": "卸载指定Microsoft软件：MS 365 App、OneNote、Visual C++、Windows Desktop Runtime",
      "tool": "RemoveMicrosoftProgram",
      "params": "-r",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤3；理由：减少后台干扰项"
    },
    {
      "order": 4,
      "action": "卸载OneDrive应用",
      "tool": "UninstallTeams",
      "params": "/name \"OneDrive\"",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤4；映射：Uninstall OneDrive app -> UninstallTeams，理由：该工具支持卸载UWP应用"
    },
    {
      "order": 5,
      "action": "卸载Microsoft Teams UWP应用",
      "tool": "UninstallTeams",
      "params": "/name \"Teams\"",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤5；理由：清除潜在后台进程"
    },
    {
      "order": 6,
      "action": "设置系统屏幕亮度为82%",
      "tool": "SetBrightness",
      "params": "/Brightness 82",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤6；理由：统一显示负载条件"
    },
    {
      "order": 7,
      "action": "设置系统默认声卡音量为0",
      "tool": "SetComputerVolume",
      "params": "/Volum 0",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤7；理由：静音以降低功耗波动"
    },
    {
      "order": 8,
      "action": "设置系统壁纸为1-Think_White.jpg",
      "tool": "ChangeOSBackgroundBattery",
      "params": "/F 1-Think_White.jpg",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤8；理由：固定视觉渲染负载"
    },
    {
      "order": 9,
      "action": "通过PDU执行硬断电关机",
      "tool": "DeviceNetRequest",
      "params": "{\"testUnitUuid\":\"4899fbed58f\",\"action\":\"poweroff\",\"testModelNodeUuid\":\"7460c72717877d7\",\"testTaskCode\":\"TT200037\",\"controlCmd\":\"Direct\"}",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤9；参数部分取自示例json，关键字段保留"
    },
    {
      "order": 10,
      "action": "设置系统电源模式为最佳能效",
      "tool": "SetPowerMode",
      "params": "/P BestPowerEfficienct",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤10；理由：确保电源策略一致"
    },
    {
      "order": 11,
      "action": "执行一次重启操作",
      "tool": "SxPowerTest",
      "params": "--TestFunction Wb --TestTimes 1 --CountDownTime 10 --SleepTime 60",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤11；简化参数，去除跳过关机标志"
    },
    {
      "order": 12,
      "action": "通过PDU执行硬上电开机",
      "tool": "DeviceNetRequest",
      "params": "{\"testUnitUuid\":\"4899fbed58f\",\"action\":\"poweron\",\"testModelNodeUuid\":\"7460c72717877d7\",\"testTaskCode\":\"TT200037\",\"controlCmd\":\"Direct\"}",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤12；同断电操作，仅变更action"
    },
    {
      "order": 13,
      "action": "将系统DPI缩放设置为100%",
      "tool": "ChangeSystemDPI",
      "params": "/V New",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤13；New在工具内映射为100%"
    },
    {
      "order": 14,
      "action": "检查电池电量是否达到100%",
      "tool": "CheckBatteryLevel",
      "params": "/Min 100",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤14；确保起始电量满格"
    },
    {
      "order": 15,
      "action": "使用MediaPlayer全屏循环播放本地预置视频",
      "tool": "PlayLocalVideo",
      "params": "-S Yes",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤15；全屏播放模拟典型负载"
    },
    {
      "order": 16,
      "action": "抓取CPU使用率并生成曲线图，采样5秒",
      "tool": "CPUUsage",
      "params": "/TestDuration 5",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤16；用于监控初始负载状态"
    },
    {
      "order": 17,
      "action": "通过PDU执行硬断电关机",
      "tool": "DeviceNetRequest",
      "params": "{\"testUnitUuid\":\"4899fbed58f\",\"action\":\"poweroff\",\"testModelNodeUuid\":\"7460c72717877d7\",\"testTaskCode\":\"TT200037\",\"controlCmd\":\"Direct\"}",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤17；中断当前会话以准备放电监测"
    },
    {
      "order": 18,
      "action": "运行ACin_auto_on.exe脚本并传递结果",
      "tool": "ACinAutoOnWrap",
      "params": "-r",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤18；检测适配器插入行为"
    },
    {
      "order": 19,
      "action": "禁用板载有线网卡",
      "tool": "ChangeLanStatus",
      "params": "/S Disable",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤19；减少网络活动干扰"
    },
    {
      "order": 20,
      "action": "启动电池放电监测，目标电量10%，采样间隔60秒",
      "tool": "BatteryCapacityDetectControl",
      "params": "/A DisCharge /P 10 /T 60",
      "note": "推断：原案例目标为3%，此处按cmd_desc调整为10%；对应上下文工具功能，DisCharge模式支持自定义目标"
    },
    {
      "order": 21,
      "action": "设置系统壁纸为1-Think_White.jpg",
      "tool": "ChangeOSBackgroundBattery",
      "params": "/F 1-Think_White.jpg",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤21；恢复一致性设置"
    },
    {
      "order": 22,
      "action": "启用板载有线网卡",
      "tool": "ChangeLanStatus",
      "params": "/S Enable",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤22；恢复网络连接"
    },
    {
      "order": 23,
      "action": "通过PDU执行硬上电开机",
      "tool": "DeviceNetRequest",
      "params": "{\"testUnitUuid\":\"4899fbed58f\",\"action\":\"poweron\",\"testModelNodeUuid\":\"7460c72717877d7\",\"testTaskCode\":\"TT200037\",\"controlCmd\":\"Direct\"}",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤23；唤醒设备进入工作状态"
    },
    {
      "order": 24,
      "action": "抓取并上传C盘根目录下的batterylife.log日志文件",
      "tool": "BatteryLifeCollectionLog",
      "params": "",
      "note": "对应上下文条目：Batterylife_Jeita_VPBTest_100_to_3，步骤24；自动上传放电过程日志"
    }
  ]
}
